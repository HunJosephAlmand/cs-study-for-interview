## 운영체제란? 
> 사용자가 컴퓨터를 사용하기 위해 필요한 소프트웨어

사용자에게 편리한 **인터페이스 환경**을 제공하고 **컴퓨터 시스템의 자원을 효율적으로 관리**하는 **소프트웨어**이다.
우리가 일반적으로 컴퓨터를 사용하면서 실행한 모든 프로그램들은 운영체제에서 관리하고 제어한다.

### 운영체제의 필요성 
초기 컴퓨터는 정해진 계산만 수행하면 됐다. 하지만 점차 메모리나 CPU의 성능이 향상되고, 여러 작업을 동시에 할 수 있는 컴퓨팅 환경이 조성되면서 사용 규칙이 필요해졌다.
이로 인해 운영체제가 나타났다. 


### 운영체제의 역할 
![](https://i.imgur.com/QoU2K1n.png)

#### 1. 자원 관리 
> 자원이란 CPU, 메모리, 하드디스크 등 하드웨어 자원뿐 아니라 소프트웨어 자원까지 통칭해서 부른다.

(한정된) 자원을 효율적으로 관리하면서 좋은 성능을 내는 동시에 자원을 형평성 있게 분배하도록 만드는 균형자 역할도 수행한다.

#### 2. 자원 보호 
사용자와 운영 체제 자신을 보호하는 역할을 수행한다. 
컴퓨터 내의 많은 자원을 악의적인 사용자로부터 자원을 보호한다. 


#### 3. 하드웨어 인터페이스 제공 
복잡한 과정 없이 다양한 장치를 사용할 수 있도록 해주는 하드웨어 인터페이스를 제공한다.  즉, 사용자는 복잡한 과정 없이 다양한 장치를 사용할 수 있게 된다. 
하드웨어 장치와 상호작용하기 위해 만들어진 컴퓨터 프로그램 즉, 하드웨어 인터페이스를 **드라이버**라고 한다.

#### 4. 사용자 인터페이스 제공 
사용자가 운영체제를 쉽게 사용하도록 지원한다. 사용자에게 GUI를 제공하며 사용자가 쉽게 작업을 수행할수 있도록 한다. 

> 구체적으로 봤을 시  
> 1. CPU 스케줄링과 프로세스 관리 
> 2. 메모리 관리 
> 3. 디스크 파일 관리 
> 4. I/O 디바이스 관리


## 운영체제 구조 
![](https://i.imgur.com/ucfryOp.png)

### 커널 
프로세스, 메모리, 저장장치 관리 등 운영체제의 핵심적인 기능을 모아놓은 것으로 운영체제의 중추적인 역할을 한다.

#### 커널의 구성 
커널의 기능은 아래와 같다. 
- 프로세스 관리 
- 메모리 관리 
- 파일 시스템 관리 
- 입출력 관리 
- 프로세스간 통신 관리 

커널은 이러한 기능을 구현하는 방법에 따라 단일형, 계층형, 마이크로 구조 커널로 구분된다.
- 단일형 구조 커널 
	- 커널의 핵심 기능을 구현하는 모듈들이 구분 없이 하나로 구성 
	- 모듈이 거의 분리되지 않았기 때문에 모듈 간의 통신 비용이 줄어들어 효율적인 운영이 가능하다. 
	- 모든 모듈이 하나로 묶여 있어 버그나 오류 처리가 어렵다.
- 계층형 구조 커널 
	- 비슷한 기능을 가진 모듈을 묶어서 하나의 계층으로 만들고 계층 간의 통신을 통해 우운영체제를 구현하는 방식 
	- 비슷한 기능을 모아 모듈화했기 때문에 버그나 오류를 쉽게 수정할 수 있다.
- 마이크로 구조 커널 
	- 프로세스, 메모리 관리, 프로세스 간 통신 관리 등 가장 기본적인 기능만 제공하는 커널 
	- 다른 커널에 비해 운영체제의 많은 부분이 사용자 영역에 구현
	- 각 모듈이 독립적으로 작동하기 때문에 한 모듈의 결함이 전체적으로 퍼지지 않는다. 
	- 하지만 통신을 많이해야 하기 때문에 성능 저하가 있다.




### 인터페이스 
커널에 사용자 명령을 전달하고 실행 결과를 사용자에게 알려주는 역할을 한다.
유닉스의 쉘이 사용자 인터페이스의 한 종류이다.

운영체제는 커널과 인터페이스를 분리하여, 같은 커널이여도 다른 인터페이스 형태로 제작이 가능하다. 즉, 같은 커널이라도 다른 인터페이스가 장착되면 사용자 입장에서는 다른 운영체제로 보인다. 유닉스의 쉘도 bash 쉘, C쉘 등 여러 종류의 쉘이 있다.


### 시스템 호출 (System Call)
![](https://i.imgur.com/J4ZJXHO.png)

운영체제가 커널에 접근하기 위한 인터페이스이다.  (운영체제의 서비스를 받기 위해 커널 함수를 호출하는 것)
커널은 사용자나 응용 프로그램으로부터 컴퓨터 자원을 보호하기 위해 자원에 직접 접근하는 것을 차단한다. 따라서, 자원을 이용하기 위해서는 시스템 호출이라는 인터페이스를 사용하여 접근하여야 한다. 
컴퓨터 자원에 대한 직접 접근을 차단함으로써 컴퓨터 자원을 보호한다. 
응용 프로그램 하드웨어 자원에 접근하거나 운영체제가 제공하는 서비스를 이용하려 할 때는 시스템 호출을 사용해야 한다. 
이를 운영체제의 API라고 부르기도 한다.
> API(Application Programming Interface) : 응용 프로그램이 자신과 연관된 프로그램을 만들 수 있도록 제공하는 인터페이스 



### 디바이스 드라이버 
> 하드웨어를 제어하기 위한 소프트웨어 

커널과 하드웨어 사이의 인터페이스이다. 커널이 모든 하드웨어에 맞는 인터페이스를 모두 개발하기 어렵다. 따라서 커널은 입출력의 기본적인 부분만 제작하고 하드웨어 특성을 반영한 소프투웨어를 하드웨어 제작자에게 받아 커널이 실행될 때 함께 실행하도록 한다. 
이때, 하드웨어 제작자가 만든 소프트웨어를 디바이스 드라이버라고 한다.


### User, Kernel Mode 
![](https://i.imgur.com/dipvKSn.png)
> CPU가 수행하는 명령에는 일반 명령과 특권 명령이 있다. 
> 일반 명령 : 메모리에서 자료를 읽어오고, CPU에서 계산 하는 등의 명령이며 모든 프로그램이 수행할 수 있는 명령 
> 특권 명령 : 보안이 필요한 명령으로 입출력 장치, 타이머 등의 장치를 접근하는 명령이며 항상 운영체제만이 수행할 수 있다. 


#### User Mode 
- 유저가 접근할 수 있는 영역을 제한적으로 두며 컴퓨터 자우너에 함부로 침범하지 못하는 모드 
- 일반 사용자 프로그램이 CPU 제어권을 가지고 명령을 수행하는 모드
- 일반 명령만 수행 가능

#### Kernel Mode 
> 사용자가 하드웨어의 자원에 접근하는 것은 매우 위험한 동작이다. 그러므로 이러한 경우에는 **모두 관리자 모드로 운영체제에서 처리하도록 한다.** (프로그램에서 소프트웨어 인터럽트를 발생시켜 운영체제에 위임한다.)
- 모든 컴퓨터 자원에 접근할 수 있는 모드 
- 운영체제가 CPU의 제어권을 가지고 명령을 수행하는 모드 
- 일반 명령과 특권 명령 모두 수행 가능

#### 모드를 구분하는 방법?
CPU 내부의 레지스터의 비트를 활용하여 플래그로 나타낸다. 이를 modebit라고 한다. 
- 0 : 커널 모드 ( 운영 체제 )
	- 운영 체제가 CPU에서 실행 중일 땐 모든 인스트럭션을 실행할 수 있다.
- 1 : 사용자 모드 (사용자 프로그램)
	- 사용자 프로그램이 CPU가질 때는 제한된 인스트러션만 실행시킬 수 있다. 
커널 모드를 거쳐 운영체제를 통해 작동한다고 해도 100% 보안을 할 순 없지만, 운영체제를 통해 작동하게 해야 막기가 쉽다.



